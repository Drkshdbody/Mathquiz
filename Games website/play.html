<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Play Math Quest Online | Compete Worldwide!</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Main CSS -->
    <link rel="stylesheet" href="css/play.css">
</head>
<body>
    <!-- Navigation -->
    <nav>
        <a href="index.html" class="logo"><i class="fas fa-gamepad"></i> Deafcanthearya</a>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About Me</a></li>
            <li><a href="project.html">Project</a></li>
            <li><a href="play.html" class="active">Play Online</a></li>
            <li><a href="learn.html">Learn The Code</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </button>
    </nav>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loader"></div>
        <p>Connecting to server...</p>
    </div>

    <!-- Game Container -->
    <div class="game-container">
        <div class="game-header">
            <h1><i class="fas fa-calculator"></i> Math Quest Online</h1>
            <p>Play, compete, and climb the global leaderboard!</p>
            <div class="online-status">
                <span class="status-dot"></span>
                <span id="onlineCount">0</span> players online
            </div>
        </div>

        <div class="game-layout">
            <!-- Main Game Area -->
            <div class="terminal">
                <div class="terminal-header">
                    <span class="terminal-dot red"></span>
                    <span class="terminal-dot yellow"></span>
                    <span class="terminal-dot green"></span>
                    <span class="terminal-title">MathQuest.exe - Online Edition v1.0</span>
                </div>
                <div class="terminal-body" id="gameArea">
                    
                    <!-- Screen: Auth Gateway -->
                    <div id="screen-welcome" class="screen active">
                        <pre class="ascii-art">
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   __  __       _   _       ___                  _                ‚ïë
‚ïë  |  \/  | __ _| |_| |__   / _ \ _   _  ___  ___| |_              ‚ïë
‚ïë  | |\/| |/ _` | __| '_ \ | | | | | | |/ _ \/ __| __|             ‚ïë
‚ïë  | |  | | (_| | |_| | | || |_| | |_| |  __/\__ \ |_              ‚ïë
‚ïë  |_|  |_|\__,_|\__|_| |_| \__\_\\__,_|\___||___/\__|             ‚ïë
‚ïë                                                                  ‚ïë
‚ïë                 üåê MULTIPLAYER ONLINE EDITION üåê                  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
                        </pre>
                        
                        <div class="name-input-container">
                            <p class="subtitle">Welcome to Math Quest Online!</p>
                            <button class="btn-game btn-primary" onclick="Auth.showScreen('signup')">
                                <i class="fas fa-user-plus"></i> Sign Up
                            </button>
                            <button class="btn-game btn-secondary" onclick="Auth.showScreen('signin')" style="margin-left:0.5rem;">
                                <i class="fas fa-sign-in-alt"></i> Sign In
                            </button>
                            <p class="hint">Create an account so others cannot use your profile.</p>
                        </div>
                    </div>

                    <!-- Screen: Sign Up -->
                    <div id="screen-signup" class="screen">
                        <h2 class="screen-title"><i class="fas fa-user-plus"></i> Sign Up</h2>
                        <div class="name-input-container">
                            <p class="subtitle">Create your Math Quest account:</p>
                            <input type="text" id="signupUsername" class="name-input" placeholder="Username (unique)" maxlength="15" autocomplete="off">
                            <input type="password" id="signupPassword" class="name-input" placeholder="Password" autocomplete="new-password">
                            <input type="password" id="signupPassword2" class="name-input" placeholder="Confirm Password" autocomplete="new-password">

                            <p class="subtitle" style="margin-top: 1rem;">Select your grade (only asked once):</p>
                            <select id="signupGrade" class="name-input">
                                <option value="">Choose grade</option>
                                <option value="8">Grade 8</option>
                                <option value="9">Grade 9</option>
                                <option value="10">Grade 10</option>
                            </select>

                            <p class="subtitle" style="margin-top: 1rem;">Profile Picture (optional URL, can change later with upload):</p>
                            <input type="url" id="signupAvatar" class="name-input" placeholder="https://example.com/my-avatar.png">

                            <br>
                            <button class="btn-game btn-primary" onclick="Auth.signup()">
                                <i class="fas fa-user-plus"></i> Create Account
                            </button>
                            <button class="btn-game btn-secondary" onclick="Auth.showScreen('signin')" style="margin-left:0.5rem;">
                                Already have an account? Sign In
                            </button>

                            <p id="signupError" class="error-msg"></p>
                        </div>
                    </div>

                    <!-- Screen: Sign In -->
                    <div id="screen-signin" class="screen">
                        <h2 class="screen-title"><i class="fas fa-sign-in-alt"></i> Sign In</h2>
                        <div class="name-input-container">
                            <p class="subtitle">Log into your account:</p>
                            <input type="text" id="signinUsername" class="name-input" placeholder="Username" maxlength="15" autocomplete="username">
                            <input type="password" id="signinPassword" class="name-input" placeholder="Password" autocomplete="current-password">

                            <br>
                            <button class="btn-game btn-primary" onclick="Auth.signin()">
                                <i class="fas fa-sign-in-alt"></i> Sign In
                            </button>
                            <button class="btn-game btn-secondary" onclick="Auth.showScreen('signup')" style="margin-left:0.5rem;">
                                Create new account
                            </button>

                            <p id="signinError" class="error-msg"></p>
                        </div>
                    </div>

                    <!-- Screen: Main Menu -->
                    <div id="screen-menu" class="screen">
                        <div class="welcome-banner">
                            <p class="subtitle">Welcome back,</p>
                            <h2 id="welcomeName"></h2>
                            <div class="player-rank">
                                <i class="fas fa-medal"></i>
                                Rank: <span id="playerRank">#--</span>
                            </div>
                        </div>

                        <div class="menu-options">
                            <div class="menu-option" onclick="Game.showScreen('screen-solo-mode')">
                                <span class="icon">üéÆ</span>
                                <div class="text">
                                    <h3>Solo Mode</h3>
                                    <p>Choose ladder & difficulty</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option highlight" onclick="Duel.showLobby()">
                                <span class="icon">‚öîÔ∏è</span>
                                <div class="text">
                                    <h3>Duel Mode <span class="live-badge">LIVE</span></h3>
                                    <p>Challenge players in real-time battles</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option" onclick="Leaderboard.show()">
                                <span class="icon">üèÜ</span>
                                <div class="text">
                                    <h3>Leaderboard</h3>
                                    <p>See top players worldwide</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option" onclick="Game.showStats()">
                                <span class="icon">üìä</span>
                                <div class="text">
                                    <h3>My Stats</h3>
                                    <p>View your performance history</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option" onclick="Shop.show()">
                                <span class="icon">üõí</span>
                                <div class="text">
                                    <h3>Points Shop</h3>
                                    <p>Spend points on duel items</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option" onclick="Profile.showMyProfile()">
                                <span class="icon">üë§</span>
                                <div class="text">
                                    <h3>My Profile</h3>
                                    <p>View and edit your avatar</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Screen: Select Solo Ladder (Grade vs Overall) -->
                    <div id="screen-solo-mode" class="screen">
                        <h2 class="screen-title">
                            <i class="fas fa-server"></i> Select Solo Server
                        </h2>

                        <div class="menu-options">
                            <div class="menu-option" onclick="Game.chooseSoloMode('grade')">
                                <span class="icon">üè´</span>
                                <div class="text">
                                    <h3>My Grade Ladder</h3>
                                    <p>Compete only with players in your grade</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option highlight" onclick="Game.chooseSoloMode('overall')">
                                <span class="icon">üåê</span>
                                <div class="text">
                                    <h3>Overall Ladder</h3>
                                    <p>Cross‚Äëserver ranking against all grades</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                        </div>

                        <div class="screen-footer">
                            <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Screen: Select Difficulty -->
                    <div id="screen-mode" class="screen">
                        <h2 class="screen-title">
                            <i class="fas fa-layer-group"></i> Select Difficulty
                        </h2>
                        
                        <div class="difficulty-grid">
                            <div class="difficulty-card easy" onclick="Game.selectDifficulty('easy')">
                                <div class="diff-icon">üü¢</div>
                                <h3>Easy</h3>
                                <p>Addition & Subtraction</p>
                                <p class="range">Easier numbers</p>
                                <div class="points">+10 pts</div>
                            </div>
                            <div class="difficulty-card medium" onclick="Game.selectDifficulty('medium')">
                                <div class="diff-icon">üü°</div>
                                <h3>Medium</h3>
                                <p>Operations by grade</p>
                                <p class="range">Moderate numbers</p>
                                <div class="points">+20 pts</div>
                            </div>
                            <div class="difficulty-card hard" onclick="Game.selectDifficulty('hard')">
                                <div class="diff-icon">üî¥</div>
                                <h3>Hard</h3>
                                <p>Harder for higher grades</p>
                                <p class="range">Large numbers</p>
                                <div class="points">+30 pts</div>
                            </div>
                            <div class="difficulty-card challenge" onclick="Game.selectDifficulty('challenge')">
                                <div class="diff-icon">üíÄ</div>
                                <h3>Challenge</h3>
                                <p>Timed Mode</p>
                                <p class="range">Very large numbers</p>
                                <div class="points">+50 pts</div>
                            </div>
                        </div>

                        <div class="screen-footer">
                            <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-solo-mode')">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Screen: Playing Solo -->
                    <div id="screen-playing" class="screen">
                        <div class="game-stats-bar">
                            <div class="stat">
                                <div class="stat-value" id="currentScore">0</div>
                                <div class="stat-label">Score</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="currentQuestion">1/10</div>
                                <div class="stat-label">Question</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="currentStreak">0 üî•</div>
                                <div class="stat-label">Streak</div>
                            </div>
                            <div class="stat">
                                <div class="stat-value" id="currentDifficulty">Medium</div>
                                <div class="stat-label">Difficulty</div>
                            </div>
                        </div>

                        <div id="timerDisplay" class="timer" style="display: none;">
                            ‚è±Ô∏è <span id="timerValue">10</span>s
                        </div>

                        <div class="question-container">
                            <div class="question-number">Question <span id="questionNum">1</span> of 10</div>
                            <div class="question-text" id="questionText">? + ? = ?</div>
                            <input type="number" id="answerInput" class="answer-input" placeholder="?" autocomplete="off">
                            <br>
                            <button class="btn-game btn-primary submit-btn" onclick="Game.submitAnswer()">
                                <i class="fas fa-check"></i> Submit
                            </button>
                            <div id="feedback" class="feedback"></div>
                        </div>

                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>

                    <!-- Screen: Game Over -->
                    <div id="screen-gameover" class="screen">
                        <div class="game-over">
                            <div class="confetti" id="confetti"></div>
                            <h2>üéâ Game Complete!</h2>
                            <div class="final-score" id="finalScore">0</div>
                            <p class="score-label">points</p>
                            <div class="grade" id="finalGrade">A+</div>
                            
                            <div id="newHighScore" class="new-record">
                                <i class="fas fa-crown"></i> NEW HIGH SCORE!
                            </div>

                            <div id="rankChange" class="rank-change"></div>
                            
                            <div class="results-grid">
                                <div class="result-item">
                                    <h4 id="resultCorrect">0/10</h4>
                                    <p>Correct</p>
                                </div>
                                <div class="result-item">
                                    <h4 id="resultAccuracy">0%</h4>
                                    <p>Accuracy</p>
                                </div>
                                <div class="result-item">
                                    <h4 id="resultStreak">0</h4>
                                    <p>Best Streak</p>
                                </div>
                            </div>

                            <div class="gameover-buttons">
                                <button class="btn-game btn-primary" onclick="Game.showScreen('screen-solo-mode')">
                                    <i class="fas fa-redo"></i> Play Again
                                </button>
                                <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                    <i class="fas fa-home"></i> Menu
                                </button>
                                <button class="btn-game btn-share" onclick="Game.shareScore()">
                                    <i class="fas fa-share"></i> Share
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Screen: Leaderboard -->
                    <div id="screen-leaderboard" class="screen">
                        <h2 class="screen-title">
                            <i class="fas fa-trophy"></i> Global Leaderboard
                        </h2>

                        <div class="leaderboard-scope">
                            <button class="scope-btn active" onclick="Leaderboard.setLadder('grade', this)">My Grade Ladder</button>
                            <button class="scope-btn" onclick="Leaderboard.setLadder('overall', this)">Overall Ladder</button>
                        </div>

                        <div class="leaderboard-tabs">
                            <button class="tab-btn active" onclick="Leaderboard.switchTab('all', this)">All Time</button>
                            <button class="tab-btn" onclick="Leaderboard.switchTab('daily', this)">Today</button>
                            <button class="tab-btn" onclick="Leaderboard.switchTab('weekly', this)">This Week</button>
                        </div>

                        <div class="leaderboard-container">
                            <div class="leaderboard-list" id="leaderboardList">
                                <div class="loading-spinner">Loading...</div>
                            </div>
                        </div>

                        <div class="screen-footer">
                            <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Screen: My Stats -->
                    <div id="screen-stats" class="screen">
                        <h2 class="screen-title">
                            <i class="fas fa-chart-bar"></i> My Statistics
                        </h2>

                        <div class="stats-overview">
                            <div class="stat-card">
                                <i class="fas fa-gamepad"></i>
                                <h4 id="statGames">0</h4>
                                <p>Games Played</p>
                            </div>
                            <div class="stat-card highlight">
                                <i class="fas fa-crown"></i>
                                <h4 id="statHighScore">0</h4>
                                <p>High Score</p>
                            </div>
                            <div class="stat-card">
                                <i class="fas fa-chart-line"></i>
                                <h4 id="statAvgScore">0</h4>
                                <p>Avg Score</p>
                            </div>
                        </div>

                        <div class="stats-details">
                            <div class="stat-row">
                                <span><i class="fas fa-check-circle"></i> Total Correct</span>
                                <span id="statTotalCorrect">0</span>
                            </div>
                            <div class="stat-row">
                                <span><i class="fas fa-percentage"></i> Avg Accuracy</span>
                                <span id="statAvgAccuracy">0%</span>
                            </div>
                            <div class="stat-row">
                                <span><i class="fas fa-fire"></i> Best Streak</span>
                                <span id="statBestStreak">0</span>
                            </div>
                            <div class="stat-row">
                                <span><i class="fas fa-user-graduate"></i> Grade Ladder Rank</span>
                                <span id="statGradeRank">#--</span>
                            </div>
                            <div class="stat-row">
                                <span><i class="fas fa-medal"></i> Overall Ladder Rank</span>
                                <span id="statGlobalRank">#--</span>
                            </div>
                            <div class="stat-row">
                                <span><i class="fas fa-swords"></i> Duels Won</span>
                                <span id="statDuelsWon">0</span>
                            </div>
                        </div>

                        <div class="screen-footer">
                            <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Screen: Points Shop -->
                    <div id="screen-shop" class="screen">
                        <h2 class="screen-title">
                            <i class="fas fa-shopping-cart"></i> Points Shop
                        </h2>

                        <p class="subtitle">Your points: <span id="shopPoints">0</span></p>

                        <div class="shop-grid" id="shopItems">
                            <!-- Filled by JS -->
                        </div>

                        <div class="screen-footer">
                            <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Screen: Profile -->
                    <div id="screen-profile" class="screen">
                        <div class="profile-page">
                            <div class="profile-card">
                                <div class="profile-header">
                                    <div class="profile-avatar-wrapper">
                                        <img id="profileAvatarImg" src="default-avatar.png" alt="Avatar" onerror="this.src='default-avatar.png'">
                                    </div>
                                    <div class="profile-main-info">
                                        <h2 id="profileUsername">Username</h2>
                                        <div class="profile-badges">
                                            <span class="badge grade-badge">Grade <span id="profileGrade">--</span></span>
                                            <span class="badge points-badge"><i class="fas fa-coins"></i> <span id="profilePoints">0</span> pts</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="profile-stats-grid">
                                    <div class="profile-stat">
                                        <span class="label">High Score</span>
                                        <span class="value" id="profileHighScore">0</span>
                                    </div>
                                    <div class="profile-stat">
                                        <span class="label">Duels Won</span>
                                        <span class="value" id="profileDuelsWon">0</span>
                                    </div>
                                    <div class="profile-stat">
                                        <span class="label">Best Streak</span>
                                        <span class="value" id="profileBestStreak">0</span>
                                    </div>
                                    <div class="profile-stat">
                                        <span class="label">Games Played</span>
                                        <span class="value" id="profileGamesPlayed">0</span>
                                    </div>
                                </div>

                                <div id="profileEditControls" class="profile-edit">
                                    <p class="subtitle">Change Avatar</p>
                                    <label class="file-upload-label">
                                        <input type="file" id="profileAvatarFile" accept="image/*" onchange="Profile.previewAvatar()">
                                        <i class="fas fa-upload"></i> Choose Image
                                    </label>
                                    <button class="btn-game btn-primary" onclick="Profile.uploadAvatar()">
                                        <i class="fas fa-cloud-upload-alt"></i> Upload Avatar
                                    </button>
                                    <p class="hint">Max ~1MB. JPG or PNG recommended.</p>
                                    <p id="profileUploadStatus" class="error-msg"></p>
                                </div>
                            </div>

                            <div class="screen-footer" style="margin-top:1.5rem;">
                                <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                    <i class="fas fa-arrow-left"></i> Back
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Screen: Duel Lobby -->
                    <div id="screen-duel-lobby" class="screen">
                        <h2 class="screen-title">
                            ‚öîÔ∏è Duel Arena
                        </h2>

                        <div class="duel-options">
                            <div class="menu-option" onclick="Duel.findMatch()">
                                <span class="icon">üé≤</span>
                                <div class="text">
                                    <h3>Quick Match</h3>
                                    <p>Find a random opponent online</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option" onclick="Duel.createPrivate()">
                                <span class="icon">üîó</span>
                                <div class="text">
                                    <h3>Create Private Room</h3>
                                    <p>Invite friends with a code</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option" onclick="Duel.showJoinRoom()">
                                <span class="icon">üö™</span>
                                <div class="text">
                                    <h3>Join Private Room</h3>
                                    <p>Enter a room code</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>

                            <div class="menu-option" onclick="Duel.playBot()">
                                <span class="icon">ü§ñ</span>
                                <div class="text">
                                    <h3>vs Computer</h3>
                                    <p>Practice against AI</p>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                        </div>

                        <div class="active-rooms" id="activeRooms">
                            <h3><i class="fas fa-door-open"></i> Active Rooms</h3>
                            <div class="rooms-list" id="roomsList">
                                <p class="no-rooms">No active rooms. Create one!</p>
                            </div>
                        </div>

                        <div class="screen-footer">
                            <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Screen: Waiting for Opponent -->
                    <div id="screen-waiting" class="screen">
                        <div class="waiting-container">
                            <div class="waiting-animation">
                                <div class="pulse-ring"></div>
                                <div class="pulse-ring delay"></div>
                                <i class="fas fa-search"></i>
                            </div>
                            <h2 id="waitingTitle">Finding Opponent...</h2>
                            <p id="waitingSubtitle">Please wait while we match you</p>
                            
                            <div id="roomCodeDisplay" class="room-code-display" style="display: none;">
                                <p>Share this code with your friend:</p>
                                <div class="room-code" id="roomCode">XXXX</div>
                                <button class="btn-game btn-secondary" onclick="Duel.copyRoomCode()">
                                    <i class="fas fa-copy"></i> Copy Code
                                </button>
                            </div>

                            <button class="btn-game btn-danger" onclick="Duel.cancelSearch()">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                    </div>

                    <!-- Screen: Join Room -->
                    <div id="screen-join-room" class="screen">
                        <h2 class="screen-title">
                            <i class="fas fa-door-open"></i> Join Private Room
                        </h2>

                        <div class="join-room-container">
                            <p>Enter the room code from your friend:</p>
                            <input type="text" id="joinRoomCode" class="room-input" placeholder="XXXX" maxlength="4" autocomplete="off">
                            <br>
                            <button class="btn-game btn-primary" onclick="Duel.joinRoom()">
                                <i class="fas fa-sign-in-alt"></i> Join Room
                            </button>
                            <p id="joinError" class="error-msg"></p>
                        </div>

                        <div class="screen-footer">
                            <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-duel-lobby')">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                        </div>
                    </div>

                    <!-- Screen: Duel Game -->
                    <div id="screen-duel" class="screen">
                        <div class="duel-header">
                            <div class="duel-player you">
                                <div class="player-avatar you">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="player-info">
                                    <span class="player-name" id="duelPlayerName">You</span>
                                    <div class="duel-score" id="duelPlayerScore">0</div>
                                    <div class="duel-lives">Lives: <span id="duelPlayerLives">3</span></div>
                                </div>
                            </div>
                            
                            <div class="vs-container">
                                <div class="round-indicator">
                                    Question <span id="duelRound">1</span>
                                </div>
                                <div class="vs-badge">VS</div>
                            </div>
                            
                            <div class="duel-player opponent">
                                <div class="player-info">
                                    <span class="player-name" id="duelOpponentName">Opponent</span>
                                    <div class="duel-score" id="duelOpponentScore">0</div>
                                    <div class="duel-lives">Lives: <span id="duelOpponentLives">3</span></div>
                                </div>
                                <div class="player-avatar opponent">
                                    <i class="fas fa-user"></i>
                                </div>
                            </div>
                        </div>

                        <div class="duel-timer" id="duelTimer">
                            <span id="duelTimeLeft">10</span>
                        </div>

                        <div class="question-container">
                            <div class="question-text" id="duelQuestion">? + ? = ?</div>
                            <input type="number" id="duelAnswer" class="answer-input" placeholder="?" autocomplete="off">
                            <br>
                            <button class="btn-game btn-primary submit-btn" onclick="Duel.submitAnswer()">
                                <i class="fas fa-check"></i> Submit
                            </button>
                            <div id="duelFeedback" class="feedback"></div>
                        </div>

                        <div class="duel-items-bar">
                            <span>Items:</span>
                            <button class="btn-item" onclick="Duel.useItem('time_potion')">‚è±Ô∏è +5s (<span id="inv_time_potion">0</span>)</button>
                            <button class="btn-item" onclick="Duel.useItem('double_points')">üìú 2x (<span id="inv_double_points">0</span>)</button>
                            <button class="btn-item" onclick="Duel.useItem('shield')">üõ°Ô∏è Shield (<span id="inv_shield">0</span>)</button>
                        </div>

                        <div class="opponent-status" id="opponentStatus">
                            <i class="fas fa-pencil-alt"></i> Opponent is answering...
                        </div>
                    </div>

                    <!-- Screen: Duel Results -->
                    <div id="screen-duel-results" class="screen">
                        <div class="duel-results">
                            <h2 id="duelResultTitle">üéâ Victory!</h2>
                            
                            <div class="duel-final-scores">
                                <div class="final-player you">
                                    <div class="final-avatar you">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <span id="duelResultPlayerName">You</span>
                                    <div class="final-score winning" id="duelResultPlayerScore">0</div>
                                </div>
                                
                                <div class="vs-final">VS</div>
                                
                                <div class="final-player opponent">
                                    <div class="final-avatar opponent">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <span id="duelResultOpponentName">Opponent</span>
                                    <div class="final-score losing" id="duelResultOpponentScore">0</div>
                                </div>
                            </div>

                            <div class="duel-stats">
                                <div class="duel-stat">
                                    <span>Your Accuracy</span>
                                    <span id="duelResultAccuracy">0%</span>
                                </div>
                                <div class="duel-stat">
                                    <span>Your Streak</span>
                                    <span id="duelResultStreak">0</span>
                                </div>
                            </div>

                            <div class="gameover-buttons">
                                <button class="btn-game btn-primary" onclick="Duel.rematch()">
                                    <i class="fas fa-redo"></i> Rematch
                                </button>
                                <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-duel-lobby')">
                                    <i class="fas fa-door-open"></i> Lobby
                                </button>
                                <button class="btn-game btn-secondary" onclick="Game.showScreen('screen-menu')">
                                    <i class="fas fa-home"></i> Menu
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Sidebar -->
            <div class="sidebar">
                <div class="sidebar-card">
                    <h3><i class="fas fa-trophy"></i> Top Players</h3>
                    <div class="sidebar-leaderboard" id="sidebarLeaderboard">
                        <div class="loading-spinner small">Loading...</div>
                    </div>
                </div>

                <div class="sidebar-card online-players">
                    <h3><i class="fas fa-users"></i> Online Now</h3>
                    <div class="online-list" id="onlinePlayersList">
                        <p class="no-players">Loading...</p>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3><i class="fas fa-info-circle"></i> How to Play</h3>
                    <ul class="how-to-play">
                        <li>Sign up or sign in to protect your account</li>
                        <li>Choose Solo ladder & difficulty</li>
                        <li>Higher grades get harder questions</li>
                        <li>Earn points in Solo & Duels</li>
                        <li>Buy items in the shop and use them in Duels</li>
                        <li>Compete on grade and overall ladders!</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notifications" class="notifications"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <!-- Game Scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/leaderboard.js"></script>
    <script src="js/shop.js"></script>
    <script src="js/duel.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/game.js"></script>
</body>
</html>